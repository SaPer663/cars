# Проект Cars
### Описание
Основные требования:

1. Создать модель для справочника "Цвета".
2. Создать модель для справочника "Марки автомобилей"
3. Создать модель для справочника "Модели автомобилей"
4. Создать модель для хранения заказов авто. Заказ должен включать в себя цвет, модель, количество, дату (по умолчанию текущая).
5. С использованием библиотеки Django Rest Framework создать RestAPI для управления справочниками и заказами. API должно реализовать операции CRUD для моделей, а также чтение списков. 
API для списка заказов должен возвращать элементы со след. атрибутами: дата заказа, цвет, марка авто, модель авто, количество.

Доп. требования:

1. Реализовать поддержку постраничного вывода списка заказов (объем страницы 10 элементов), реализовать сортировку списка заказов по количеству, реализовать фильтрацию списка заказов по марке авто
2. Обеспечить пользовательское представление API в формате OpenApi (Swagger).
3. Реализовать API для получения след. информации: список цветов с указанием количества заказанных авто каждого цвета (атрибуты элементов: цвет, количество), список марок с указанием количества заказанных авто каждой марки (атрибуты элементов: марка, количество)

Допущения:
1. Поставщик в состоянии поставить любое количество авто любой марки/модели любого цвета

Ограничения:
1. Все поля всех моделей обязательны к заполнению, кроме даты заказа. В случае непередачи даты заказа в запросе заказ создается с текущей датой.
### Технологии
- [`django-rest-framework`](https://www.django-rest-framework.org/) для API
- [`poetry`](https://github.com/python-poetry/poetry) для управления зависимостями
- [`flake8`](http://flake8.pycqa.org/en/latest/) линтер
- [`drf-yasg`](https://github.com/axnsan12/drf-yasg/) для документации API

### Запуск проекта в dev-режиме
Для запуска проекта необходимо:
- склонируйте репозиторий
```
git clone git@github.com:SaPer663/cars.git
```
- в директории `infra/` создайте `.env` на основе `.env.template`
```
DB_ENGINE - указать СУБД 
DB_NAME - имя базы данных
POSTGRES_USER - логин пользователя базы данных PostgreSQL
POSTGRES_PASSWORD - пароль пользователя базы данных PostgreSQL
DB_HOST - IP адрес сервера базы данных PostgreSQL
DB_PORT - порт сервера базы данных PostgreSQL

DJANGO_SECRET_KEY - секретный ключ
DJANGO_DEBUG - режим работы сервера
```

- из директории `infra/` соберите образ контейнера
```
docker-compose build
```
- запустите контейнер
```
docker-compose up -d
```
После запуска контейнера неоходимо:
- применить миграции и собрать статику
```
docker-compose exec web python manage.py migrate
docker-compose exec web python manage.py collectstatic --no-input
```
- зарегестрировать админа
```
docker-compose exec web python manage.py createsuperuser
```
Для проверки работы можно наполнить базу данными
```
docker-compose exec web python manage.py loaddata data.json
```
### Документация
После запуска сервера документация API доступна по адресу:
- [swagger](http://0.0.0.0/api/swagger/)

### Автор
Александр
